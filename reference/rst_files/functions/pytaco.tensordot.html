

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pytaco.tensordot &mdash; Taco  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pytaco.tensor.insert" href="pytaco.tensor.insert.html" />
    <link rel="prev" title="pytaco.outer" href="pytaco.outer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Taco
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Home:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../datatype.html">Datatypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../format.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_io.html">Tensor IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sched.html">Scheduling Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_expressions.html">Index Expressions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tensors.html">Tensors</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tensor_class.html">Tensor Class</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tensor_info.html">Tensor Compute Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_abs.html">pytaco.tensor_abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_square.html">pytaco.tensor_square</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_cube.html">pytaco.tensor_cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_sqrt.html">pytaco.tensor_sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_cube_root.html">pytaco.tensor_cube_root</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_exp.html">pytaco.tensor_exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_log.html">pytaco.tensor_log</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_log10.html">pytaco.tensor_log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_sin.html">pytaco.tensor_sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_cos.html">pytaco.tensor_cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_tan.html">pytaco.tensor_tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_asin.html">pytaco.tensor_asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_acos.html">pytaco.tensor_acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_atan.html">pytaco.tensor_atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_atan2.html">pytaco.tensor_atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_sinh.html">pytaco.tensor_sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_cosh.html">pytaco.tensor_cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_tanh.html">pytaco.tensor_tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_asinh.html">pytaco.tensor_asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_acosh.html">pytaco.tensor_acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_atanh.html">pytaco.tensor_atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_logical_not.html">pytaco.tensor_logical_not</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_sum.html">pytaco.tensor_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_add.html">pytaco.tensor_add</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_mul.html">pytaco.tensor_mul</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_div.html">pytaco.tensor_div</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_sub.html">pytaco.tensor_sub</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_pow.html">pytaco.tensor_pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_gt.html">pytaco.tensor_gt</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_lt.html">pytaco.tensor_lt</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_ge.html">pytaco.tensor_ge</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_le.html">pytaco.tensor_le</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_eq.html">pytaco.tensor_eq</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_ne.html">pytaco.tensor_ne</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_max.html">pytaco.tensor_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_min.html">pytaco.tensor_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.tensor_heaviside.html">pytaco.tensor_heaviside</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.as_type.html">pytaco.as_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.matmul.html">pytaco.matmul</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.inner.html">pytaco.inner</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.dot.html">pytaco.dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="pytaco.outer.html">pytaco.outer</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">pytaco.tensordot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tensor_info.html#tensor-manipulation-functions">Tensor Manipulation functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../parsers.html">Evaluate String Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../udfs.html">User Defined Functions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Taco</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tensors.html">Tensors</a> &raquo;</li>
        
          <li><a href="../tensor_info.html">Tensor Compute Functions</a> &raquo;</li>
        
      <li>pytaco.tensordot</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/rst_files/functions/pytaco.tensordot.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pytaco-tensordot">
<h1>pytaco.tensordot<a class="headerlink" href="#pytaco-tensordot" title="Permalink to this headline">Â¶</a></h1>
<dl class="function">
<dt id="pytaco.tensordot">
<code class="descclassname">pytaco.</code><code class="descname">tensordot</code><span class="sig-paren">(</span><em>t1</em>, <em>t2</em>, <em>axes=2</em>, <em>out_format=mode_format(compressed)</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytaco.tensordot" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the tensor dot product along the specified axes for tensors of order &gt;= 1.</p>
<p>Given two tensors and an iterable containing two iterables <code class="docutils literal notranslate"><span class="pre">(t1_axes,</span> <span class="pre">t2_axes)</span></code>, sum the products
of t1 and t2 elements over the axes specified by <code class="docutils literal notranslate"><span class="pre">t1_axes</span></code> and <code class="docutils literal notranslate"><span class="pre">t2_axes</span></code>. The third (axes) argument
can be a non-negative integer scalar such as N. In this case, the last <code class="docutils literal notranslate"><span class="pre">N</span></code> dimensions of t1 and the first
<code class="docutils literal notranslate"><span class="pre">N</span></code> dimensions of t2 are summed over.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t1, t2: tensor, array_like, dimensions &gt;= 1</strong></dt><dd><p>The two tensors we would like to dot.</p>
</dd>
<dt><strong>axes: int or array_like</strong></dt><dd><ul class="simple">
<li><p>If an integer, sum over the last N axes of t1 and the first N axes of t2. The size of the dimensions must
match.</p></li>
<li><p>If array_like or a list of axes to sum over, the first iterable is the list of axes applying to t1 and the
second iterable is a list of axes applying to t2</p></li>
</ul>
</dd>
<dt><strong>out_format: format, mode_format, optional</strong></dt><dd><ul class="simple">
<li><p>If a <a class="reference internal" href="../format_class.html#pytaco.format" title="pytaco.format"><code class="xref py py-class docutils literal notranslate"><span class="pre">format</span></code></a> is specified, the result tensor is stored in the format out_format.</p></li>
<li><p>If a <a class="reference internal" href="../mode_format.html#pytaco.mode_format" title="pytaco.mode_format"><code class="xref py py-class docutils literal notranslate"><span class="pre">mode_format</span></code></a> is specified, the result the result tensor has a with all of the dimensions
stored in the <a class="reference internal" href="../mode_format.html#pytaco.mode_format" title="pytaco.mode_format"><code class="xref py py-class docutils literal notranslate"><span class="pre">mode_format</span></code></a> passed in.</p></li>
</ul>
</dd>
<dt><strong>dtype: Datatype</strong></dt><dd><p>The datatype of the output tensor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>result: tensor</dt><dd><p>The contraction of the two tensors passed in based on the axes given.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When there is more than one axis to sum over - and they are not the last axis of t1 and the first axis of t2,
the argument axes should consist of two sequences of the same length, with the first axis to sum over given
first in both sequences, the second axis second, and so forth.</p>
<p>As with all expressions, some sparse tensors cannot be computed without explicity transposing  because taco is
unable to simultaneously iterate over both tensors. In this case, an error will be thrown asking that the user
transposes one of the tensors.</p>
<p class="rubric">Examples</p>
<p>Here we use an example where we show using the axes as a list. We âdotâ the 1st axis of t1 with the 0-th axis
of t2 and the 0th axis of t1 with the 1st axis of t2.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytaco</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytaco</span> <span class="k">import</span> <span class="n">compressed</span><span class="p">,</span> <span class="n">dense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csr_matrix</span><span class="p">,</span> <span class="n">csc_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">60.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">24.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">shape</span>
<span class="go">[5, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
<span class="go">array([[   0.,   60.],</span>
<span class="go">       [  36.,  340.],</span>
<span class="go">       [ 186.,  996.],</span>
<span class="go">       [ 528., 2184.],</span>
<span class="go">       [ 564., 2272.]])</span>

<span class="go"># We can use sparse tensors to do the same thing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt1</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">compressed</span><span class="p">,</span> <span class="n">dense</span><span class="p">,</span> <span class="n">compressed</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">compressed</span><span class="p">,</span> <span class="n">dense</span><span class="p">,</span> <span class="n">compressed</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">remove_explicit_zeros</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">fmt1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">remove_explicit_zeros</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">fmt2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">t3</span><span class="p">,</span><span class="n">t4</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">out_format</span><span class="o">=</span><span class="n">dense</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
<span class="go">array([[   0.,   60.],</span>
<span class="go">       [  36.,  340.],</span>
<span class="go">       [ 186.,  996.],</span>
<span class="go">       [ 528., 2184.],</span>
<span class="go">       [ 564., 2272.]])</span>
</pre></div>
</div>
<p>Note that in the above, we had to switch the mode ordering in order to allow taco to perform the computation.
In general, when dealing with sparse structures, assuming our axes are in the form <code class="docutils literal notranslate"><span class="pre">(a_axes,</span> <span class="pre">b_axes)</span></code> we want to
ensure that <code class="docutils literal notranslate"><span class="pre">a_axes[i]</span> <span class="pre">==</span> <span class="pre">b_axes[mode_ordering[i]]</span></code>. For the curious, we are currently exploring ways to lift
this restriction.</p>
<p>Also note that the above example is equivalent to writing <code class="docutils literal notranslate"><span class="pre">Res[k,</span> <span class="pre">l]</span> <span class="pre">=</span> <span class="pre">t3[j,</span> <span class="pre">i,</span> <span class="pre">k]</span> <span class="pre">*</span> <span class="pre">t4[i,</span> <span class="pre">j,</span> <span class="pre">l]</span></code> in index
notation.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pytaco.tensor.insert.html" class="btn btn-neutral float-right" title="pytaco.tensor.insert" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pytaco.outer.html" class="btn btn-neutral float-left" title="pytaco.outer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MIT COMMIT GROUP

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>