<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tensor Format Object &mdash; TACO Python API Reference</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Format Functions" href="format_funcs.html" />
    <link rel="prev" title="Mode Formats" href="mode_format.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> TACO Python API Reference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="datatype.html">Data Types</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="format.html">Formats</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mode_format.html">Mode Formats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tensor Format Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="format_funcs.html">Format Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="file_io.html">Tensor I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="sched.html">Scheduling Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_expressions.html">Index Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensors.html">Tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsers.html">Evaluating String Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="udfs.html">User-Defined Functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TACO Python API Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="format.html">Formats</a> &raquo;</li>
      <li>Tensor Format Object</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rst_files/format_class.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tensor-format-object">
<h1>Tensor Format Object<a class="headerlink" href="#tensor-format-object" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pytaco.format">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytaco.</span></span><span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytaco.format" title="Permalink to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="tensor_class.html#pytaco.tensor" title="pytaco.tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensor</span></code></a> format.</p>
<p>The modes have the given mode storage formats and are stored in the given sequence. Mode i has the <a class="reference internal" href="mode_format.html#pytaco.mode_format" title="pytaco.mode_format"><code class="xref py py-class docutils literal notranslate"><span class="pre">mode_format</span></code></a>
specified by mode_formats[mode_ordering[i]].</p>
<p>If no arguments are given a format for a 0-order tensor (a scalar) is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mode_formats: pytaco.mode_format, iterable of pytaco.mode_format, optional</strong></dt><dd><p>A list representing the mode format used to store each mode (dimension) of the tensor specified by mode_ordering[i].
If a single <a class="reference internal" href="mode_format.html#pytaco.mode_format" title="pytaco.mode_format"><code class="xref py py-class docutils literal notranslate"><span class="pre">mode_format</span></code></a> is given, then a format for a 1-order tensor (vector) is created. The
default value is the empty list meaning a scalar is created.</p>
</dd>
<dt><strong>mode_ordering: int, iterable of ints, optional</strong></dt><dd><p>Can be specified if len(mode_formats) &gt; 1. Specifies the order in which the dimensions (modes) of the tensor
should be stored in memory. That is, the mode stored in the i-th position in memory is specified by mode_ordering[i].
Defaults to mode_ordering[i] = i which corresponds to row-major storage.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>PyTaco exports the following common formats:</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">csr</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">CSR</span></code> - Compressed Sparse Row storage format.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">csc</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">CSC</span></code> - Compressed Sparse Columns storage format.</p>
<p class="rubric">Examples</p>
<p>Here, we will create two common storage formats CSR and CSC in order to better understand formats. First, we look at
CSR.</p>
<p>We need a mode formats list to tell taco the first dimension it stores should be dense and the second dimension
should be sparse.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytaco</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mode_formats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt</span><span class="o">.</span><span class="n">dense</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">compressed</span><span class="p">]</span>
</pre></div>
</div>
<p>We then need to tell taco the order in which to store the dimensions. Since we want CSR, we want to store the rows first
then the columns. Once we do this, we can make the format.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mode_ordering</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># Taco will default this if no ordering is given.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csr</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode_formats</span><span class="p">,</span> <span class="n">mode_ordering</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csr</span><span class="o">.</span><span class="n">order</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Now, it is easy to make a CSC format given what we have already. For CSC, we want to store the columns before the rows
but also have the columns be dense and the rows be sparse. We do so as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mode_ordering_csc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csc</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode_formats</span><span class="p">,</span> <span class="n">mode_ordering_csc</span><span class="p">)</span>
</pre></div>
</div>
<p>This tells taco to store the columns before the rows due to the ordering given and to store the columns as dense since
they are now the first storage dimension and the mode_formats[0] is dense.</p>
<p>We can generalize this to make a large number of storage formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></dt><dd><p>Returns the number of modes (dimensions) stored in a format.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mode_formats</span></code></dt><dd><p>Returns the storage types of the modes.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mode_ordering</span></code></dt><dd><p>Returns a list representing the ordering in which the modes are stored.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mode_format.html" class="btn btn-neutral float-left" title="Mode Formats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="format_funcs.html" class="btn btn-neutral float-right" title="Format Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 TACO Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>