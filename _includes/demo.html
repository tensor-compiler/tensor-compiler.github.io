<div class="mdl-grid" style="padding-top: 0px">
  <div class="mdl-cell mdl-cell--12-col">
    <p style="line-height: 100%">This is a prototype implementation of the sparse tensor algebra compiler theory and contains known bugs, which are documented <a href="https://github.com/tensor-compiler/taco/issues">here</a>. If you find additional issues, please consider submitting a bug report.</p>
    <h6 style="margin-bottom: 0px; margin-top: 18px">Input a tensor algebra expression in index notation to generate code that computes it:</h6>
    <div class="input-bar">
      <div class="mdl-textfield expr-input">
        <input id="txtExpr" class="input" value="y(i) = A(i,j) * x(j)" style="font-family: monospace" spellcheck="false" autocomplete="off" autocorrect="false" autocapitalize="false">
        <span id="lblError" class="mdl-textfield__error" style="font-size: 14px"></span>
        <label class="mdl-textfield__label"></label>
      </div>
      <div class="input-bar-misc">
        <div style="float: left">
          <button id="btnExamples" class="mdl-button mdl-js-button mdl-button--icon">
            <i class="material-icons">more_vert</i>
          </button>
          <ul id="listExamples" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" style="margin-top: 0em; margin-left: 0em" for="btnExamples"></ul>
        </div>
        <div class="mdl-textfield prefix-input">
          <input id="prefix" class="input" placeholder="Prefix (Optional)" style="font-family: monospace" spellcheck="false" autocomplete="off" autocorrect="false" autocapitalize="false">
        </div>
        <button id="btnGetKernel" class="button is-primary demo-btn">Generate Kernel</button>
      </div>
    </div>
  </div>
</div>

<div id="tblFormats" class="mdl-grid" style="padding-top: 0px; padding-bottom: 0px">
  <div class="mdl-cell mdl-cell--12-col" style="margin-top: 2px">
    <table class="mdl-data-table mdl-js-data-table" style="width: 100%; margin-bottom: 8px">
      <thead>
        <tr>
          <th class="mdl-data-table__cell--non-numeric" style="min-width: 70px; vertical-align: middle; padding-left: 9px">
            <div align="center" style="position:relative"><big>Tensor</big></div></th>
          <th class="mdl-data-table__cell--non-numeric" style="width: 100%; padding-left: 0px; vertical-align: middle; text-align: left">
            <div style="display: flex">
              <div style="width: 190px">
                <big style="text-align: center; display: inline-block; width: 100%">
                  Format
                  <button class="help-btn help-btn-alternate js-modal-trigger mdl-button mdl-js-button mdl-button--icon" data-target="modal-level-formats"><i class="material-icons" style="font-size: 20px">help_outline</i></button>
                </big>
              </div>
              <big class="optional-header" style="padding-left: 28px">
                (Level Formats)
                <button class="help-btn js-modal-trigger mdl-button mdl-js-button mdl-button--icon" data-target="modal-level-formats"><i class="material-icons" style="font-size: 20px">help_outline</i></button>
              </big>
              <div id="modal-level-formats" class="modal">
                <div class="modal-background"></div>
                <div class="modal-content">
                  <div class="box">
                    <p>
                      TACO represents tensor formats as compositions of the 
                      following per-dimension level formats:
                    </p>
                    <p>
                      <strong>Dense</strong> levels store the size of the dimension 
                      $(N)$ and encode the coordinates in the interval $[0, N)$.
                      <img src="images/dense-arrays.jpg" class="centered-img" style="height: 29px; padding-top:10px">
                    </p>
                    <p>
                      <strong>Compressed</strong> levels store coordinates in a 
                      segment of the $\texttt{crd}$ array, with segment bounds 
                      stored in the $\texttt{pos}$ array.
                      <img src="images/compressed-arrays.jpg" class="centered-img" style="height: 50px; padding-top:10px">
                    </p> 
                    <p>
                      <strong>Singleton</strong> levels store individual 
                      coordinates in the $\texttt{crd}$ array.
                      <img src="images/singleton-arrays.jpg" class="centered-img" style="height: 30px; padding-top:10px">
                    </p>
                    <p>
                      Some level formats also come in different variants that 
                      either can only store unique elements (U) or may store 
                      duplicate elements (&not;U). More details can be found 
                      <a href="files/chou-oopsla18-taco-formats.pdf">here</a>.
                    </p>
                    <p>
                      TACO also supports non-row major tensor formats such as CSC.
                      You can define non-row major tensor formats in the web tool by  
                      <strong>dragging the drop-down menus to reorder dimensions</strong>.
                    </p>
                  </div>
                </div>
                <button class="modal-close is-large" aria-label="close"></button>
              </div>
            </div>
          </th>
        </tr>
      </thead>
      <tbody id="listTensors">
      </tbody>
    </table>
  </div>
</div>

<div class="mdl-grid" style="padding-top: 8px; padding-bottom: 0px">
  <div class="mdl-cell mdl-cell--12-col">
    <div align="right" style="padding-right: 0px">
      <button id="btnCPU" class="button is-primary sample-button">
        Sample CPU Schedule
      </button>
      <button id="btnGPU" class="button is-primary sample-button">
        Sample GPU Schedule
      </button>
    </div>
    <table class="mdl-data-table mdl-js-data-table" style="width: 100%; margin-bottom: 8px">
      <thead>
        <tr>
          <th class="mdl-data-table__cell--non-numeric"></th>
          <th class="mdl-data-table__cell--non-numeric" style="padding-left: 0px; padding-right: 8px; vertical-align: middle; text-align: left">
            <div style="display: flex">
              <div style="width: 200px">
                <big style="text-align: center; display: inline-block; width: 100%">
                  Scheduling Command
                  <button class="help-btn mdl-button mdl-js-button mdl-button--icon">
                    <a target="_blank" rel="noopener noreferrer" href="http://tensor-compiler.org/docs/scheduling.html">
                      <i class="material-icons" style="font-size: 20px; color: black">help_outline</i>
                    </a>
                  </button>
                </big>
              </div>
              <div>
                <big class="optional-header" style="padding-left: 28px">
                  Arguments
                </big>
              </div>
            </div>
          </th>
        </tr>
      </thead>
      <tbody id="tblSchedule">
      </tbody>
    </table>
  </div>
</div>

<div class="mdl-grid" style="padding-top: 6px">
  <div class="mdl-cell mdl-cell--12-col output-panel">
    <div id="panelKernels" class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
      <table style="width: 100%; margin-bottom: 0px">
        <tr>
          <td style="padding: 0px; padding-bottom: 8px">
            <div class="mdl-tabs__tab-bar" style="justify-content: flex-start">
                <a style="padding-left: 12px; padding-right: 12px" href="#compute-panel" class="mdl-tabs__tab is-active">Compute Code</a>
                <a style="padding-left: 12px; padding-right: 12px" href="#assembly-panel" class="mdl-tabs__tab">Assemble Code</a>
                <a style="padding-left: 12px; padding-right: 12px" href="#full-panel" class="mdl-tabs__tab">Full Code</a>
            </div>
          </td>
          <td id="cellBtnDownload" align="right">
            <button id="btnDownload" class="button is-primary" style="width: 100%">Download</button>
          </td>
        </tr>
      </table>
      <div class="mdl-tabs__panel is-active" id="compute-panel">
        <pre style="margin: 0px 0px; padding: 0px 0px"><code id="txtComputeLoops" class="lang-cpp">/* The generated compute code will appear here */</code></pre>
      </div>
      <div class="mdl-tabs__panel" id="assembly-panel">
        <pre style="margin: 0px 0px; padding: 0px 0px"><code id="txtAssemblyLoops" class="lang-cpp">/* The generated assemble code will appear here */</code></pre>
      </div>
      <div class="mdl-tabs__panel" id="full-panel">
        <pre style="margin: 0px 0px; padding: 0px 0px"><code id="txtFullCode" class="lang-cpp">/* The complete generated code will appear here */</code></pre>
      </div>
    </div>
    <br>
    <p style="line-height: 100%">The generated code is provided "as is" without warranty of any kind. To help us improve TACO, we keep an anonymized record of all requests submitted to the TACO online server.</p>
  </div>
</div>

<script>demo()</script>
